<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Calculators</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <!-- Chart.js for the graph -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Verdana, Arial, Helvetica, sans-serif;
            background-color: #ffffff;
            margin: 0;
            padding: 0;
            color: #333;
            font-size: 13px;
        }

        /* --- Header Section --- */
        .top-nav {
            background-color: #ffffff;
            text-align: center;
            padding: 10px 0;
            font-weight: bold;
            color: #444;
            text-transform: uppercase;
            font-size: 11px;
            letter-spacing: 1px;
        }
        .top-nav span { 
            margin: 0 15px; 
            cursor: pointer; 
            padding-bottom: 2px;
        }
        .top-nav span.active-tab {
            color: #cf6a28;
            border-bottom: 2px solid #cf6a28;
        }
        .top-nav span:hover {
            color: #cf6a28;
        }

        .header-bar {
            background: linear-gradient(to bottom, #e68a45 0%, #cf6a28 100%); /* Orange Gradient */
            padding: 15px 20px;
            position: relative;
            border-bottom: 1px solid #b05315;
        }

        .header-bar h1 {
            margin: 0;
            color: white;
            font-family: "Georgia", "Times New Roman", serif;
            font-weight: normal;
            font-size: 32px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        /* Currency Box in top right */
        .currency-box {
            position: absolute;
            top: 15px;
            right: 20px;
            background: white;
            padding: 5px;
            border: 1px solid #aaa;
            border-radius: 3px;
            font-size: 11px;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        .currency-box span { font-weight: bold; margin-right: 5px; }
        .currency-btns { display: inline-block; vertical-align: middle; }
        .currency-btns button {
            border: 1px solid #ccc;
            background: #f0f0f0;
            cursor: pointer;
            font-size: 10px;
            padding: 1px 4px;
            margin-right: 2px;
        }
        .currency-btns button.active {
            background: #cf6a28;
            color: white;
            border-color: #b05315;
        }

        /* --- Main Layout --- */
        .main-container {
            max-width: 900px;
            width: 100%;
            margin: 20px auto;
            padding: 0 15px;
            box-sizing: border-box;
        }

        /* Description Box */
        .description-box {
            border: 1px solid #ccc;
            padding: 15px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            background: #f9f9f9;
            line-height: 1.5;
        }
        .desc-col { flex: 1; }

        /* --- Calculator Box (The Beige Area) --- */
        .calculator-box {
            background-color: #f2f0eb; /* Exact beige tone */
            border: 1px solid #bbb;
            padding: 15px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.05);
        }

        /* Grid Layout for Calc */
        .calc-grid {
            display: grid;
            grid-template-columns: 180px 180px 1fr; /* Inputs | Results | Chart */
            gap: 20px;
        }

        h3 {
            font-size: 14px;
            margin: 0 0 10px 0;
            color: #000;
            font-weight: bold;
        }

        /* Inputs */
        .input-group { margin-bottom: 10px; }
        .input-group label {
            display: block;
            margin-bottom: 2px;
            font-size: 12px;
        }
        input[type="number"], input[type="text"] {
            width: 100%;
            padding: 8px 4px; /* Larger touch target */
            border: 1px solid #aaa;
            font-size: 16px; /* Prevent iOS zoom */
            box-sizing: border-box;
        }

        /* ... existing styles ... */

        /* Media Queries for Mobile */
        @media (max-width: 768px) {
            .calc-grid {
                grid-template-columns: 1fr;
            }
            
            .description-box {
                flex-direction: column;
                gap: 10px;
            }
            
            .header-bar h1 {
                font-size: 24px;
                margin-top: 30px; /* Space for currency box */
            }
            
            .currency-box {
                top: 10px;
                right: 10px;
            }
            
            .chart-wrapper {
                height: 250px;
            }

            .top-nav {
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 10px;
            }
            
            .top-nav span {
                margin: 0 5px;
            }
        }

        /* Results (Read only look) */
        .result-group { margin-bottom: 10px; }
        .result-group label {
            display: block;
            margin-bottom: 2px;
            font-size: 12px;
            font-weight: bold;
        }
        .result-val {
            background-color: #fff;
            border: 1px solid #fff; /* Looks like text but with white bg */
            padding: 4px;
            font-weight: bold;
            font-size: 14px;
        }

        /* Button */
        button.calculate-btn {
            margin-top: 10px;
            background: linear-gradient(to bottom, #89c4f4, #5ca0d6);
            border: 1px solid #4a8bc2;
            color: white;
            padding: 6px 15px;
            cursor: pointer;
            font-weight: bold;
            border-radius: 3px;
            width: 100%;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
        }
        button.calculate-btn:hover {
            background: linear-gradient(to bottom, #5ca0d6, #4a8bc2);
        }

        /* Chart Area */
        .chart-wrapper {
            background: #f2f0eb; 
            height: 300px;
            width: 100%;
        }

        /* Text below chart */
        .bottom-text {
            margin-top: 30px;
        }
        .bottom-text h2 {
            font-family: Arial, sans-serif;
            color: #333;
            font-size: 24px;
            border-bottom: 1px solid #ccc;
            padding-bottom: 5px;
        }
        
        .hidden {
            display: none;
        }

    </style>
</head>
<body>

<!-- Top Navigation -->
<div class="top-nav">
    <span onclick="switchTab('compound')" id="tab-compound" class="active-tab">Compound Interest</span>
    <span onclick="switchTab('lifestyle')" id="tab-lifestyle">Lifestyle Burn</span>
    <span onclick="switchTab('time')" id="tab-time">Time Value</span>
</div>

<!-- Orange Header -->
<div class="header-bar">
    <h1 id="header-title">Compound Interest Calculator</h1>
    <div class="currency-box">
        <span>Currency</span>
        <div class="currency-btns">
            <button class="active" onclick="setCurrency('$')">USD</button>
            <button onclick="setCurrency('£')">GBP</button>
            <button onclick="setCurrency('€')">EUR</button>
            <button onclick="setCurrency('A$')">AUD</button>
        </div>
    </div>
</div>

<div class="main-container">
    
    <!-- VIEW: COMPOUND INTEREST -->
    <div id="view-compound">
        <!-- Explanatory Text -->
        <div class="description-box">
            <div class="desc-col">
                COMPOUND INTEREST IS THE CONCEPT of earning interest on your investment, then earning interest on your investment plus the interest. Over time this results in the exponential growth of your money.
            </div>
            <div class="desc-col">
                This compound interest calculator demonstrates the power of compounding interest by graphically showing the value of your investment, broken down into the principal, any monthly deposits and the accumulated interest earned.
                <br><br>Javascript is required.
            </div>
        </div>

        <!-- Calculator Section (Beige Box) -->
        <div class="calculator-box">
            <div class="calc-grid">
                
                <!-- Column 1: Inputs -->
                <div class="col-inputs">
                    <h3>Calculate your return</h3>
                    
                    <div class="input-group">
                        <label>Principal <span class="c-sym">$</span>:</label>
                        <input type="number" id="principal" value="1000">
                    </div>
                    
                    <div class="input-group">
                        <label>Monthly Deposit <span class="c-sym">$</span>:</label>
                        <input type="number" id="monthly" value="20">
                    </div>

                    <div class="input-group">
                        <label>% Rate:</label>
                        <input type="number" id="rate" value="5.3">
                    </div>

                    <div class="input-group">
                        <label>Years:</label>
                        <input type="number" id="years" value="30">
                    </div>

                    <button id="calculate-btn" class="calculate-btn">Calculate</button>
                </div>

                <!-- Column 2: Results -->
                <div class="col-results">
                    <h3>Results</h3>
                    
                    <div class="result-group">
                        <label>Final Balance</label>
                        <div class="result-val" id="res-balance">$ 22,486</div>
                    </div>

                    <div class="result-group">
                        <label>Total Deposits</label>
                        <div class="result-val" id="res-deposits">$ 7,200</div>
                    </div>

                    <div class="result-group">
                        <label>Total Interest</label>
                        <div class="result-val" id="res-interest">$ 14,286</div>
                    </div>
                </div>

                <!-- Column 3: Chart -->
                <div class="col-chart">
                    <h3>Chart: Accumulated Return</h3>
                    <div class="chart-wrapper">
                        <canvas id="growthChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Text -->
        <div class="bottom-text">
            <h2>How the Compound Interest Calculator Works</h2>
            <p>A mathematical formula for calculating compound interest (as used by this online calculator), can be stated as...</p>
        </div>
    </div>

    <!-- VIEW: LIFESTYLE BURN -->
    <div id="view-lifestyle" class="hidden">
        <!-- Explanatory Text -->
        <div class="description-box">
            <div class="desc-col">
                LIFESTYLE BURN CALCULATOR helps you understand how much pre-tax (gross) income you need to earn to support your monthly spending habits.
            </div>
            <div class="desc-col">
                Input your monthly expenses and your estimated effective tax rate. We will calculate the salary required to maintain that lifestyle after taxes are paid.
            </div>
        </div>

        <!-- Calculator Section -->
        <div class="calculator-box">
            <div class="calc-grid">
                
                <!-- Column 1: Inputs -->
                <div class="col-inputs">
                    <h3>Your Lifestyle</h3>
                    
                    <div class="input-group">
                        <label>Monthly Spending <span class="c-sym">$</span>:</label>
                        <input type="number" id="ls-burn" value="5000">
                    </div>

                    <div class="input-group">
                        <label>Estimated Tax Rate (%):</label>
                        <input type="number" id="ls-tax" value="30">
                    </div>

                    <button id="ls-calculate-btn" class="calculate-btn">Calculate Income</button>
                </div>

                <!-- Column 2: Results -->
                <div class="col-results">
                    <h3>Required Earnings</h3>
                    
                    <div class="result-group">
                        <label>Annual Gross Salary</label>
                        <div class="result-val" id="ls-res-annual">$ 85,714</div>
                    </div>

                    <div class="result-group">
                        <label>Monthly Gross Income</label>
                        <div class="result-val" id="ls-res-monthly">$ 7,143</div>
                    </div>
                    
                    <div class="result-group">
                        <label>Monthly Taxes</label>
                        <div class="result-val" id="ls-res-taxes">$ 2,143</div>
                    </div>
                </div>

                <!-- Column 3: Chart -->
                <div class="col-chart">
                    <h3>Chart: Income Breakdown</h3>
                    <div class="chart-wrapper">
                        <canvas id="lifestyleChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="bottom-text">
            <h2>Understanding Your Lifestyle Cost</h2>
            <p>This calculator assumes the "Burn" is your net spending (after tax). The calculation reverses the tax rate to find the gross income required.</p>
            <p>Formula: <code>Gross Income = Net Spend / (1 - Tax Rate)</code></p>
        </div>
    </div>

    <!-- VIEW: TIME VALUE -->
    <div id="view-time" class="hidden">
        <!-- Explanatory Text -->
        <div class="description-box">
            <div class="desc-col">
                BUY BACK YOUR TIME CALCULATOR determines your "Aspirational Hourly Rate" based on your income goals and desired work-life balance.
            </div>
            <div class="desc-col">
                Use this to decide whether to outsource a task or do it yourself. If the cost to outsource is lower than your hourly rate, you should buy back your time.
            </div>
        </div>

        <!-- Calculator Section -->
        <div class="calculator-box">
            <div class="calc-grid">
                
                <!-- Column 1: Inputs -->
                <div class="col-inputs">
                    <h3>Your Goals</h3>
                    
                    <div class="input-group">
                        <label>Target Annual Income <span class="c-sym">$</span>:</label>
                        <input type="number" id="tv-income" value="200000">
                    </div>

                    <div class="input-group">
                        <label>Work Hours / Week:</label>
                        <input type="number" id="tv-hours" value="30">
                    </div>

                    <div class="input-group">
                        <label>Weeks Off / Year:</label>
                        <input type="number" id="tv-weeks-off" value="4">
                    </div>

                    <hr style="border: 0; border-top: 1px solid #ccc; margin: 15px 0;">
                    
                    <h3>Task Decision</h3>
                    <div class="input-group">
                        <label>Task Cost <span class="c-sym">$</span>:</label>
                        <input type="number" id="tv-task-cost" value="100">
                    </div>
                    <div class="input-group">
                        <label>Time Saved (Hours):</label>
                        <input type="number" id="tv-task-time" value="5">
                    </div>

                    <button id="tv-calculate-btn" class="calculate-btn">Analyze Decision</button>
                </div>

                <!-- Column 2: Results -->
                <div class="col-results">
                    <h3>Your Value</h3>
                    
                    <div class="result-group">
                        <label>Aspirational Hourly Rate</label>
                        <div class="result-val" id="tv-res-rate">$ 139</div>
                    </div>

                    <div class="result-group">
                        <label>Task Effective Hourly Cost</label>
                        <div class="result-val" id="tv-res-task-rate">$ 20</div>
                    </div>
                    
                    <div class="result-group">
                        <label>Decision</label>
                        <div class="result-val" id="tv-res-decision" style="color: green;">OUTSOURCE IT</div>
                    </div>
                </div>

                <!-- Column 3: Chart -->
                <div class="col-chart">
                    <h3>Chart: Value Comparison</h3>
                    <div class="chart-wrapper">
                        <canvas id="timeChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="bottom-text">
            <h2>How to Use This Tool</h2>
            <p>This tool calculates your hourly worth based on your *target* lifestyle, not just your current one. Use it to validate spending money to save time.</p>
            <p>Formula: <code>Hourly Rate = Target Income / ((52 - Weeks Off) * Hours Per Week)</code></p>
        </div>
    </div>

</div>

<script>
    let currency = '$';
    let myChart = null;
    let lsChart = null;
    let tvChart = null;

    // Setup on load
    document.addEventListener('DOMContentLoaded', () => {
        // Initial Compound Calc
        runCalculation();
        document.getElementById('calculate-btn').addEventListener('click', runCalculation);
        
        // Lifestyle Calc
        runLifestyleCalculation();
        document.getElementById('ls-calculate-btn').addEventListener('click', runLifestyleCalculation);

        // Time Value Calc
        runTimeCalculation();
        document.getElementById('tv-calculate-btn').addEventListener('click', runTimeCalculation);

        // Handle Enter key for all calculators
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Enter') {
                // Avoid double submission if user is focused on the button itself
                if (document.activeElement.tagName === 'BUTTON') return;

                if (!document.getElementById('view-compound').classList.contains('hidden')) {
                    runCalculation();
                } else if (!document.getElementById('view-lifestyle').classList.contains('hidden')) {
                    runLifestyleCalculation();
                } else if (!document.getElementById('view-time').classList.contains('hidden')) {
                    runTimeCalculation();
                }
            }
        });
    });

    function switchTab(tabName) {
        // Update Tabs
        document.getElementById('tab-compound').classList.remove('active-tab');
        document.getElementById('tab-lifestyle').classList.remove('active-tab');
        document.getElementById('tab-time').classList.remove('active-tab');
        document.getElementById('tab-' + tabName).classList.add('active-tab');

        // Update Views
        document.getElementById('view-compound').classList.add('hidden');
        document.getElementById('view-lifestyle').classList.add('hidden');
        document.getElementById('view-time').classList.add('hidden');
        document.getElementById('view-' + tabName).classList.remove('hidden');

        // Update Header
        const titles = {
            'compound': 'Compound Interest Calculator',
            'lifestyle': 'Lifestyle Income Calculator',
            'time': 'Time Value Calculator'
        };
        document.getElementById('header-title').innerText = titles[tabName];
    }

    function setCurrency(sym) {
        currency = sym;
        // Update all currency symbols in UI
        document.querySelectorAll('.c-sym').forEach(el => el.innerText = sym);
        
        // Update buttons active state
        document.querySelectorAll('.currency-btns button').forEach(btn => {
            btn.classList.remove('active');
            if(btn.innerText.includes(sym) || (sym === '$' && btn.innerText === 'USD') || (sym === 'A$' && btn.innerText === 'AUD')) {
                btn.classList.add('active');
            }
        });
        
        // Re-run visible calc
        runCalculation();
        runLifestyleCalculation();
        runTimeCalculation();
    }

    function fmt(num) {
        return currency + " " + Math.round(num).toLocaleString();
    }

    // --- COMPOUND INTEREST LOGIC ---
    function runCalculation() {
        // Get Values
        const P = parseFloat(document.getElementById('principal').value);
        const M = parseFloat(document.getElementById('monthly').value);
        const R = parseFloat(document.getElementById('rate').value);
        const T = parseFloat(document.getElementById('years').value);

        // Logic
        let balance = P;
        let totalDep = P;
        let totalInt = 0;

        let labels = [];
        let dataP = []; // Principal (Blue)
        let dataD = []; // Deposits (Orange)
        let dataI = []; // Interest (Green)

        // Loop Years
        let displayInterval = Math.ceil(T / 15); 

        for(let y=1; y<=T; y++) {
            // Calculate 12 months
            for(let m=0; m<12; m++) {
                let interest = balance * (R / 100 / 12);
                balance += interest + M;
                totalDep += M;
                totalInt += interest;
            }

            // Add to chart data
            labels.push(y + " Years");
            dataP.push(P);
            dataD.push(totalDep - P);
            dataI.push(totalInt);
        }

        // Update Text Results
        document.getElementById('res-balance').innerText = fmt(balance);
        document.getElementById('res-deposits').innerText = fmt(totalDep);
        document.getElementById('res-interest').innerText = fmt(totalInt);

        // Render Chart
        drawChart(labels, dataP, dataD, dataI);
    }

    function drawChart(labels, p, d, i) {
        const ctx = document.getElementById('growthChart').getContext('2d');
        
        if(myChart) myChart.destroy();

        myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [
                    {
                        label: 'Principal',
                        data: p,
                        backgroundColor: '#0000ff', 
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    },
                    {
                        label: 'Deposits',
                        data: d,
                        backgroundColor: '#ffaa00', 
                    },
                    {
                        label: 'Interest',
                        data: i,
                        backgroundColor: '#008000', 
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        stacked: true,
                        grid: { display: false },
                        ticks: { font: { size: 10 }, maxTicksLimit: 8 }
                    },
                    y: {
                        stacked: true,
                        grid: { color: '#e0e0e0' },
                        title: { display: true, text: 'Balance ' + (currency === '$' ? 'USD' : '') }
                    }
                },
                plugins: {
                    legend: { position: 'top' }
                }
            }
        });
    }

    // --- LIFESTYLE BURN LOGIC ---
    function runLifestyleCalculation() {
        const burn = parseFloat(document.getElementById('ls-burn').value) || 0;
        const taxRate = parseFloat(document.getElementById('ls-tax').value) || 0;
        
        // Calculations
        // Net Annual Needed
        const netAnnual = burn * 12;
        
        // Gross Annual Needed = Net / (1 - TaxRate)
        // Guard against 100% tax rate
        let grossAnnual = 0;
        if(taxRate < 100) {
            grossAnnual = netAnnual / (1 - (taxRate / 100));
        }

        const grossMonthly = grossAnnual / 12;
        const monthlyTax = grossMonthly - burn;

        // Update Results
        document.getElementById('ls-res-annual').innerText = fmt(grossAnnual);
        document.getElementById('ls-res-monthly').innerText = fmt(grossMonthly);
        document.getElementById('ls-res-taxes').innerText = fmt(monthlyTax);

        // Draw Chart
        drawLifestyleChart(burn, monthlyTax);
    }

    function drawLifestyleChart(burn, tax) {
        const ctx = document.getElementById('lifestyleChart').getContext('2d');
        
        if(lsChart) lsChart.destroy();

        lsChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Lifestyle Burn (Net)', 'Taxes'],
                datasets: [{
                    data: [burn, tax],
                    backgroundColor: [
                        '#ffaa00', // Orange for spend
                        '#0000ff'  // Blue for tax
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'right'
                    },
                    title: {
                        display: true,
                        text: 'Monthly Gross Income Breakdown'
                    }
                }
            }
        });
    }

    // --- TIME VALUE LOGIC ---
    function runTimeCalculation() {
        const income = parseFloat(document.getElementById('tv-income').value) || 0;
        const hours = parseFloat(document.getElementById('tv-hours').value) || 1;
        const weeksOff = parseFloat(document.getElementById('tv-weeks-off').value) || 0;
        
        const taskCost = parseFloat(document.getElementById('tv-task-cost').value) || 0;
        const taskTime = parseFloat(document.getElementById('tv-task-time').value) || 1;

        // Calculations
        const workingWeeks = 52 - weeksOff;
        const totalHours = workingWeeks * hours;
        
        let hourlyRate = 0;
        if (totalHours > 0) {
            hourlyRate = income / totalHours;
        }

        let taskRate = 0;
        if (taskTime > 0) {
            taskRate = taskCost / taskTime;
        }

        const shouldOutsource = taskRate < hourlyRate;

        // Update Results
        document.getElementById('tv-res-rate').innerText = fmt(hourlyRate);
        document.getElementById('tv-res-task-rate').innerText = fmt(taskRate);
        
        const decisionEl = document.getElementById('tv-res-decision');
        if(shouldOutsource) {
            decisionEl.innerText = "OUTSOURCE IT";
            decisionEl.style.color = "green";
        } else {
            decisionEl.innerText = "DO IT YOURSELF";
            decisionEl.style.color = "red"; // Or maybe orange? Red implies 'stop outsourcing'
        }

        // Draw Chart
        drawTimeChart(hourlyRate, taskRate);
    }

    function drawTimeChart(myRate, taskRate) {
        const ctx = document.getElementById('timeChart').getContext('2d');
        
        if(tvChart) tvChart.destroy();

        tvChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['My Hourly Rate', 'Task Cost / Hour'],
                datasets: [{
                    label: 'Value ($)',
                    data: [myRate, taskRate],
                    backgroundColor: [
                        '#0000ff', // My Rate
                        taskRate < myRate ? '#008000' : '#ff0000' // Green if good deal, Red if bad
                    ],
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: { display: true, text: 'Hourly Value' }
                    }
                },
                plugins: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: 'Value Comparison'
                    }
                }
            }
        });
    }

</script>

</body>
</html>